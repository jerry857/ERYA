<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
<meta name="viewport" content="width=device-width">
<title>做作业</title>
    <link href="/space/new/css/ZuoYe-android.css?v=2020-0415-1500" type="text/css" rel="stylesheet"/>
<link href="/css/connLine.css" rel="stylesheet" type="text/css" />
<link href="/css/work-css-tpl.cssx?enc=3d6194a1847d274d297e4de381702765" rel="stylesheet" type="text/css" />
<link href="/css/questionBank/questionBankUsual.css?v=2019-1120-1400" type="text/css" rel="stylesheet"/><script>var isIpad=0;var downpath="";</script>
	<script type="text/javascript" src="/js/common/jquery.min.js"></script>
<script type="text/javascript" src="/js/common/jquery-migrate.min.js"></script><script src="/space/new/js/right2.js"></script>
<script src="/static/js/domain.js"></script>
<script src="/space/new/js/wayer_v1.2.mini.js" ></script>
<script src="/js/check_vercode.js" type="text/javascript"></script>
<script src="/ananas/space/exam/js/enc_js_work.js?v=1603463962782"></script>
<link href="/css/work/viewer.min.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/space/work/js/viewer-jquery.min.js"></script>
<script type="text/javascript">
try{
	$(function(){
		var imgList = $(".TiMu").find("div img:not(.workAttach img, .attach img, .attachNew img, .stuAnswerArea img)");
		for (var i = 0, len = imgList.size(); i < len; i++) {
			 var src = imgList.eq(i).attr("src");
			 if(src){
    			var index = src.indexOf("375_1024");
    			if (index != -1) {
    				src = src.replace("375_1024", "origin");
    			}
                 var index2 = src.indexOf("750_1024");
                 if (index2 != -1) {
                     src = src.replace("750_1024", "origin");
                 }
    			imgList.eq(i).attr("data-original", src);
		   }
		}
        $(".TiMu").find("div img:not(.workAttach img, .attach img, .attachNew img, .stuAnswerArea img)").viewer({
			url : 'data-original',
		});
	})
  }catch(error){}
</script><style>
	.mask{width:100%;height:100%;background:#fff;opacity:0.6;position:absolute;z-index:10000;top:0;left:0;}
	.AlertCon02{width:528px;height:238px;border:solid 1px #c5c5c5;background:#FFF;padding:10px;margin:0 auto;bottom:220px;position: fixed;left: 50%;margin-left: -172px;z-index:10001;}
	.closed02{width:14px;height:14px;background:url(/space/new/moocIndex/images/icons.png) no-repeat left -283px;}
	.con03{padding:20px;text-align:center;font-size:16px;color:#202020;}
	.marTop30{margin-top:30px;}
	.bluebtn{display:inline-block;height:28px;line-height:25px;padding:0 10px;background:#7b9e31;font-size:14px;color:#FFF;border-radius:2px;}
	.bluebtn:hover{color:#FFF;background:#4b6f00;}
	.graybtn{display:inline-block;height:28px;line-height:25px;padding:0 10px;background:#f4f4f4;font-size:14px;color:#202020;border-radius:2px;}
	.graybtn:hover{color:#202020;background:#e3e0e0;}
	.marleft10{margin-left:20px;}
    em{font-style: italic;}
</style>
<script>
function myEditor_paste(o, html) {
    html.html = "";
    alert("只能录入不能粘贴");
}

function pasteText(){
	alert("只能录入不能粘贴");
}

//编辑器显示

// 隐藏编辑器
// function hideXhover(_this,eq) {
//
// 	var vs = UE.getEditor("answerEditor"+eq);
// 	$("input[name=answer"+eq+"]").val(vs.getPlainTxt());
//
// 	$(_this).parent().parent().slideUp("slow",function () {
// 		$(".Zy_ulTk li input[name=flag"+eq+"]").parent().show();
// 	});
//     UE.getEditor("answerEditor" + eq).setContent("");
// }
</script>
	    <script type="text/javascript" charset="utf-8" src="/js/editor20150812/ueditor.config.js?v=2020-0619-1827"></script>
<script type="text/javascript" charset="utf-8" src="/js/editor20150812/ueditor.all.min.js?v=2020-0624-2051"></script>
<script>
    function getcookie(objname){
    	var arrstr = document.cookie.split("; ");
    	for(var i = 0;i < arrstr.length;i ++){
    		var temp = arrstr[i].split("=");
    		if(temp[0] == objname){
    			return unescape(temp[1]);
    		}
    	}
    }

	window.UEDITOR_CONFIG.forbidDownload = 'false';
	window.UEDITOR_CONFIG.scaleEnabled = true;
	window.UEDITOR_CONFIG.imageUrl = "https://mooc-upload-ans.chaoxing.com/ueditorupload/upload-image?uid="+getcookie("_uid") + "&enc=a329bb1b1d2e3bd91c8d46869f12b3a7&t=1603463962779&uploadtype=work";
	window.UEDITOR_CONFIG.fileUrl = "https://mooc-upload-ans.chaoxing.com/ueditorupload/attachment?uid="+getcookie("_uid") + "&enc=a329bb1b1d2e3bd91c8d46869f12b3a7&t=1603463962779&uploadtype=work";
</script>    <script type="text/javascript" charset="utf-8">
        var allowPaste = "0";
        if(allowPaste == 1){
            window.UEDITOR_CONFIG.disableDraggable = true;
        }
    </script>
</head>

<style>
	.Zy_TItle .clearfix p{display:block;}
</style>

<body>

	<div class="clearfix">
        <div class="RightCon" id="RightCon" style="padding:0 10px 0px;width:auto;min-height:0;position:relative;">
    		<div class="radiusBG">
                <div class="CeYan">
										        			        				<div class="ZyTop" style="margin-top:2px;">
                        	<h3>2.2.2&#31456;&#33410;&#27979;&#39564;<span style="font-size:16px;top:25px;color:#db2727;padding-left:10px;">
            				                                									                						待做
                					            					            				            				</span></h3>

                        </div>
												<form action="addStudentWorkNewWeb?_classId=31907027&courseid=214553024&token=a7d30b697ee56ae94946441f6911b7dd&totalQuestionNum=6151a9b7a2ba374e43de4a8ee13b605e" method="post" name="form1" id="form1" >
            				<!--是否提交还是暂不提交-->
            				<input type="hidden" name="pyFlag" id="pyFlag"/>

            				<!--需要传递的参数-->
            				<input type="hidden" name="courseId" id="courseId" value="214553024"/>
            				<input type="hidden" id="classId" name="classId" value="31907027" />
            				<input type="hidden" name="api" id="api" value="1"/>
            				<input type="hidden" name="workAnswerId" id="workAnswerId" value="22256865"/>
            				<input type="hidden" name="totalQuestionNum" id="totalQuestionNum" value="6151a9b7a2ba374e43de4a8ee13b605e"/><!--总题数-->
            				            				<input type="hidden" name="fullScore" id="fullScore" value="100.0"/><!--满分-->
            				<input type="hidden" name="knowledgeid" id="knowledgeid" value="349156581"/><!--章节id-->
            				<input type="hidden" name="oldSchoolId" id="oldSchoolId" value=""/><!--原始作业单位id-->
            				<input type="hidden" name="oldWorkId" id="oldWorkId" value="7400f6dec6a64c02a0520f391e3cab3a"/><!--最原始原始作业id-->
            				<input type="hidden" name="jobid" id="jobid" value="work-7400f6dec6a64c02a0520f391e3cab3a"/>
							<input type="hidden" name="workRelationId" id="workRelationId" value="10047699"/>
							<input type="hidden" name="enc" id="enc" value=""/>
							<input type="hidden" name="enc_work" id="enc_work" value="a7d30b697ee56ae94946441f6911b7dd"/>
							<input type="hidden" id="userId" name="userId" value="146189992"/>
                      		<div class="ZyBottom" id="ZyBottom">
                            	<!--单选题开始-->


										<div class="TiMu">
                                            <div class="Zy_TItle clearfix">
                                                <i class="fl">1</i>
                								<div class="clearfix" style="line-height: 35px; font-size: 14px;padding-right:15px;">【单选题】<p>过季的衣服除（&nbsp; ）需要用衣架挂之外，其它衣物可以分门别类用防潮袋扎紧放好，节省空间</p></div>
                                            </div>
                    						                    							                								<div class="clearfix">
                        							<ul class="Zy_ulTop w-top fl" style="padding-left:10px;">
                        								                        									                        									<li>
                        										<label class="fl before">
                        											<input name="answer400797791" type="radio" value="A"   />&nbsp;&nbsp;A
                        										</label>
                        										<a href="javascript:void(0);" class="fl after" style="padding-left:10px;"><p>大衣和皮衣</p></a>
                        										<div class="clear"></div>
                        									</li>
                    									                        									                        									<li>
                        										<label class="fl before">
                        											<input name="answer400797791" type="radio" value="B"   />&nbsp;&nbsp;B
                        										</label>
                        										<a href="javascript:void(0);" class="fl after" style="padding-left:10px;"><p>衬衫和毛衣</p></a>
                        										<div class="clear"></div>
                        									</li>
                    									                                                    </ul>

                    								<input type="hidden" id="answertype400797791" name="answertype400797791" value="0"/>
												</div>

												<div class="Py_answer clearfix">
													                        						</div>



										<div class="TiMu">
                                            <div class="Zy_TItle clearfix">
                                                <i class="fl">2</i>
                								<div class="clearfix" style="line-height: 35px; font-size: 14px;padding-right:15px;">【判断题】<p>真丝和棉质衣服不能与樟脑丸同放，会损害衣物。</p></div>
                                            </div>
                    																	<div class="clearfix">
												<div class="Py_tk">
                        							 <ul class="Zy_ulBottom clearfix">
                        								<li style="width:50px;"><label><b class="ri"></b><input type="radio" name="answer400797792" value="true" ></label></li>
                                                        <li style="width:50px;"><label><b class="wr"></b><input  type="radio" name="answer400797792" value="false"  /></label></li>
                                                    </ul>
												</div>
                								<input type="hidden" id="answertype400797792" name="answertype400797792" value="3"/>
                                              </div>

                                              <div class="Py_answer clearfix">
												                              				  </div>


											                                      																		        						            					<input type="hidden" id="answerwqbid" name="answerwqbid"/>
                            </div>
            			</form>
						    						                        		<div class="ZY_sub clearfix">
                                    												<a class="btnGray_1" href="javascript:void(0);" onclick="noSubmit();"><span title="暂时保存"  id="tempsave">暂时保存</span></a>
                                    		<a class="Btn_blue_1 marleft10" href="javascript:void(0);" onclick="btnBlueSubmit();"><span title="">提交</span></a>
                                    	                                </div>
    											           			            	</div>
    		</div>
    		<div class="mask" style="display:none"></div>
			<div class="AlertCon02" style="width:322px;height:139px;display:none;position:absolute;" id="confirmSubWin">
				<h3 class="clearfix"><a href="javascript:void(0);" class="closed02 fr" onclick="hideWindow();"></a></h3>
				<div class="con03">
			    	<p id="tipContent">确认提交？</p>
			        <div class="marTop30">
			        	<a href="javascript:void(0);" class="bluebtn " onclick="form1submit();">确定</a>
			            <a href="javascript:void(0);" class="btnGray_1 marleft10" onclick="hideWindow();">取消</a>
			        </div>
			    </div>
			</div>
    	</div>
	</div>

	<div class="AlertCon02" style="width:322px;height:139px;display:none;position:absolute;" id="submitBack">
		<h3 class="clearfix"><a href="javascript:void(0);" class="closed02 fr" onclick="$('#submitBack').css('display','none');$('.mask').css('display','none');"></a></h3>
		<div class="con03">
	    	<p id="tipContent">很遗憾，未达到及格线，请重做</p>
	        <div class="marTop30">
	        	<a href="javascript:void(0);" class="bluebtn" id="submitBackOk">确定</a>
	            <a href="javascript:void(0);" class="btnGray_1 marleft10" id="submitBackCancel">取消</a>
	        </div>
	    </div>
	</div>

    <script type="text/javascript">
    	$(function(){
    		    	});

		function hideWindow() {
			$("#confirmSubWin").css("display","none");
			$(".mask").css("display","none");
		}

		var submitLock = 0;
		function form1submit() {
			function version(url) {
				var pos = "";
				try {
					pos = getEnc();
				} catch (e) {}

				url += '&ua=' + clientType();
				url += '&formType=' + getformType();
				url += '&saveStatus=' + 1;
				url += '&pos=' + pos;

				var re = /&version=(\d)/;
				var version = 1;
				if (re.test(url)) {
					var arr = re.exec(url);
					version += parseInt(arr[1]);
					url = url.replace(re, '&version=' + version);
				} else {
					url = url + '&version=1';
				}
				return url;
			}

			if (submitLock != 0) {
				return false;
			}
			submitLock = 1;

			var ajax_url = version(document.form1.action);
			console.log(ajax_url);
			console.log(ajax_url);
			console.log(ajax_url);
			var ajax_type = $("#form1").attr("method");
			var ajax_data = $("#form1").serialize();
			console.log(ajax_data);
			console.log(ajax_data);
			console.log(ajax_data);
			$.ajax({
				type : ajax_type,
				url : ajax_url,
				data : ajax_data,
				dataType : "json",
				success : function(data) {
					if ( !data.status) {
						alert(data.msg);
						window.location.reload();
						return false;
					}

					if (data.stuStatus == 5) {
						$("#submitBackOk").unbind();
						$("#submitBackOk").on("click", function() {
							window.location.href = data.backUrl;
						});
						$("#submitBackCancel").unbind();
						$("#submitBackCancel").on("click", function() {
							window.location.href = data.url;
						});
						$(".mask").css("display","block");
    					$("#submitBack").css("display","block");
					} else {
						window.location.href = data.url;
					}
				}
			});
		}

		function btnBlueSubmit() {
			validateTimeNew(31907027, 214553024, function() {
				toadd(arguments);
			});
		}

		function validateTimeNew(classId, courseId, callback) {
			$.ajax({
				type : "GET",
				url : "/work/validate",
				cache : false,
				data : {
					classId : classId,
					courseId : courseId
				},
				success : function(data) {
					if (data.status == 1) {
						alert("账号发生异常，请重新登录！");
						return;
					}
					if (data.status == 2) {
						// 弹出验证码
																																										callback && callback('', '');
					}
					if (data.status == 3) {
						callback && callback('', '');
					}
				}
			});
		}

    	function toadd(enc){
		    $("#enc").val(arguments[0][0]);
    		$("#pyFlag").val("");
        	//try {
        		//parent.ed_complete();
        	//}catch (e) {

        	//}
    		var a = "400797791,400797792,";
        	$("#answerwqbid").val(a);
    		var jiandaId = "";
    		var wordNum = "";
    		var flagAnswer = true;
    		if(parseInt(wordNum) > 0) {
        		if(jiandaId != "") {
        			var jiandaIdArr = jiandaId.split(",");
        			for(var i=0;i<jiandaIdArr.length;i++) {
        				var temp = $("#answer" + jiandaIdArr[i]).val();
        				if((wordNum != "" && removeAllSpace(temp, i).length < parseInt(wordNum)) || (wordNum != "" && removeAllSpace(temp, i) == "")) {
        					alert("您最少输入" + wordNum + "个字");
        					flagAnswer = false;
        					break;
        				}
        			}
        		}
    		}
    		if(!flagAnswer) {
    			return;
    		}
    		setConnLineAnswer();
            setSortQuesAnswer();
            setCompoundQuesAnswer();
            setProceduralQuesAnswer();
    		var questionIds = a.split(",");
    		var flag = false;
    		var tipStr = "";
			for (var i = 0; i < questionIds.length - 1; i++) {
                var id = questionIds[i];
                var type = $("#answertype" + id).val();
        		if([4,5,6,7,8].indexOf(Number(type))==0){
        			var answer = $("#answer" + id).val();
        			var editorAnswer;
                    try {
                        var optEditor = UE.getEditor("answer" + id);
                        if (optEditor != null) {
                           editorAnswer =optEditor.getContent();
        				   if(typeof(editorAnswer) != "undefined" && editorAnswer.length>65535){
        				   		alert("提交失败，简答题字数超出范围！");
        						return;
        				   }
                        }
                    } catch(exception) {}
        		}
        	}
    		for(var i=0;i<questionIds.length - 1;i++) {
    			var id = questionIds[i];
    			var type = $("#answertype" + id).val();
    			if(type == "0") {
    				var answer = $("input:radio[name=answer"+id+"]:checked").val();
    				if(typeof(answer) == "undefined" || removeAllSpace(answer).length == 0) {
    					flag = true;
    					tipStr = "单选题";
    					break;
    				}
    			} else if(type == "1") {
    				//多选
    				var answer = $("#answer" + id).val();
    				if(typeof(answer) == "undefined" || removeAllSpace(answer).length == 0) {
    					flag = true;
    					tipStr = "多选题";
    					break;
    				}
    			}else if (type == "11") {     //连线题
                    var answer = $("#answer" + id).val();
        		    var answer_array= JSON.parse(answer);
            		 for(var index in answer_array){
                			 var content=answer_array[index].content;
                			 if(content==""||content.length==0){
                			   flag = true;
                                tipStr = "连线题";
                                break;
            				  }
            		 }
             }else if(type == "12") {
    				//投票题
    				var answer = $("#answer" + id).val()||$("input:radio[name=answer"+id+"]:checked").val();
    				if(typeof(answer) == "undefined" || removeAllSpace(answer).length == 0) {
    					flag = true;
    					tipStr = "投票题";
    					break;
    				}
				}else if(type == "13") {
                    var answer = $("#answer" + id).val();
                    if(typeof(answer) == "undefined" || removeAllSpace(answer).length == 0) {
                        flag = true;
                        tipStr = "排序题";
                        break;
                    }
             }else if (type == "14" || type == "15" || type == "16" || type == "19") {  //新完型填空、新阅读理解
                     var typeTip="完型填空";
                     if(type == "15") {
                       typeTip="阅读理解";
                     }
                     if(type == "16") {
                       typeTip="综合题";
                     }
                     if(type == "19") {
                       typeTip="听力题";
                     }
                     var answer = $("#answer" + id).val();
                     var answer_array= JSON.parse(answer);
                     var answerContent=answer_array[0];
                     for(var key in answerContent){
                             var content=answerContent[key];
                             var answerStr=content.answer;
                             var innerType=content.type;
                             if(innerType&&innerType==2){
                                 for(var index in answerStr){
                                     var item=answerStr[index];
                                     var content=item.content;
                                     if(content==""||content.length==0){
                                       flag=true;
                                       break;
                                     }
                                 }
                             }
                             if(innerType==3){
                               answerStr=answerStr.toString();
                             }
                             if(flag||answerStr==""||answerStr.length==0){
                                flag = true;
                                break;
                              }
                      }
                     if(flag){
                       tipStr = typeTip;
                       break;
                      }
              }  else if (type == "17") {
                try {
                   var language=$("#procedural-"+id+" #languageSelect").val();
                    if(language == "-1"){
                        flag = true;
                        tipStr = "程序题";
                        break;
                    }
                    var editor = UE.getEditor("textarea" + id);
                    var pureTxt=editor && editor.getContentTxt();
                    if(pureTxt.length == 0 || pureTxt == ""){
                        flag = true;
                        tipStr = "程序题";
                        break;
                    }
               } catch(exception) {}
          } else if(type == "2" || type == "9" || type == "10") {
    				//填空
    				var blankNum = $("input[name=tiankongsize"+id+"]").val();
    				var tem = false;
    				for(var j=1;j<=parseInt(blankNum);j++) {
    					// var answer = $("input[name=answer" + id + j + "]").val();
						// if(typeof(answer) != "undefined"  && removeAllSpace(answer).length != 0) {
    					// 	tem = true;
    					// 	break;
    					// }
						// try{
            			// 	var optEditor = UE.getEditor("answerEditor"+ id + j);
            			// 	if(optEditor != null){
            			// 		answer = UE.getEditor("answerEditor"+ id + j).getContent();
            			// 	}
            			// }catch(exception){
            			// }
                        var answer;
                        try {
                            var optEditor = UE.getEditor("answerEditor" + id + j);
                            if (optEditor != null) {
                                answer = optEditor.getContent();
                            }
                        } catch (exception) {}
    					if(typeof(answer) != "undefined"  && removeAllSpace(answer).length != 0) {
    						tem = true;
    						break;
    					}
    				}
    				if(!tem) {
						if(type == "2"){
        					tipStr = "填空题";
        					flag = true;
    						break;
						}
						if(type == "9"){
        					tipStr = "完型填空题";
        					flag = true;
    						break;
    					}
						if(type == "10"){
        					tipStr = "阅读理解题";
        					flag = true;
    						break;
    					}
    				}

    			} else if(type == "3") {
    				//判断
    				var answer = $("input:radio[name=answer"+id+"]:checked").val();
    				if(typeof(answer) == "undefined" || removeAllSpace(answer).length == 0) {
    					flag = true;
    					tipStr = "判断题";
    					break;
    				}
    			} else if(type == "4" || type == "18"){
    				var answer = $("#answer" + id).val();
					try{
            				var optEditor = UE.getEditor("answer"+ id);
            				if(optEditor != null){
            					answer = UE.getEditor("answer"+ id).getContent();
            				}
            			}catch(exception){
            			}
    				if(typeof(answer) == "undefined" || removeAllSpace(answer).length == 0) {
    					flag = true;
    					if(type == "18"){
    						tipStr = "口语题";
    					} else {
    						tipStr = "简答题";
    					}
    					break;
    				}
    			} else if(type == "5"){
    				var answer = $("#answer" + id).val();
					try{
            				var optEditor = UE.getEditor("answer"+ id);
            				if(optEditor != null){
            					answer = UE.getEditor("answer"+ id).getContent();
            				}
            			}catch(exception){
            			}
    				if(typeof(answer) == "undefined" || removeAllSpace(answer).length == 0) {
    					flag = true;
    					tipStr = "名词解释题";
    					break;
    				}
    			} else if(type == "6"){
    				var answer = $("#answer" + id).val();
					try{
            				var optEditor = UE.getEditor("answer"+ id);
            				if(optEditor != null){
            					answer = UE.getEditor("answer"+ id).getContent();
            				}
            			}catch(exception){
            			}
    				if(typeof(answer) == "undefined" || removeAllSpace(answer).length == 0) {
    					flag = true;
    					tipStr = "论述题";
    					break;
    				}
    			} else if(type == "7"){
    				var answer = $("#answer" + id).val();
					try{
            				var optEditor = UE.getEditor("answer"+ id);
            				if(optEditor != null){
            					answer = UE.getEditor("answer"+ id).getContent();
            				}
            			}catch(exception){
            			}
    				if(typeof(answer) == "undefined" || removeAllSpace(answer).length == 0) {
    					flag = true;
    					tipStr = "计算题";
    					break;
    				}
    			} else {
    				var answer = $("#answer" + id).val();
					try{
            				var optEditor = UE.getEditor("answer"+ id);
            				if(optEditor != null){
            					answer = UE.getEditor("answer"+ id).getContent();
            				}
            			}catch(exception){
            			}
    				if(typeof(answer) == "undefined" || removeAllSpace(answer).length == 0) {
    					flag = true;
    					tipStr = "其它";
    					break;
    				}
    			}
    		}
    		if(flag) {
    			$("#tipContent").text("您还有未做完的" + tipStr + "，确认提交吗？");
    			$(".mask").css("display","block");
    			$("#confirmSubWin").css("display","block");
    		} else {
    			$("#tipContent").text("确认提交？");
    			$(".mask").css("display","block");
    			$("#confirmSubWin").css("display","block");
    		}
    	}

    	function removeAllSpace(str, value) {
    		//var tem = ""
        	//if(value != 0) {
        		//tem = value + "";
        	//}
    		//var temp = "window.parent.UE.instants"+tem+"[&#39;ueditorInstant0&#39;]._setup(document);";
      		//return str.replace(/<[^>]+>/g,"").replace(/&nbsp;/ig,"").replace(/\s+/g, "");
    		return str.replace(/<\s?img[^>]*>/gi, "图片").replace(/<[^>]+>/g,"").replace(/&nbsp;/ig,"").replace(/\s+/g, "");
    	}

         var tempSave=false;
    	function noSubmit(){
            if(tempSave){
             return;
            }
    	    var a = "400797791,400797792,";
        	$("#answerwqbid").val(a);
        	$("#pyFlag").val("1");
    		setConnLineAnswer();
			setSortQuesAnswer();
            setCompoundQuesAnswer();
            setProceduralQuesAnswer();
           tempSave=true;
           $("#tempsave").text("正在暂存...");

			var totalQuestionNum = $("#totalQuestionNum").val();
    		//临时保存或时间到系统自动提交试卷
    		var ajax_url = "/work/addStudentWorkNew?_classId="+$("#classId").val()+"&courseid="+$("#courseId").val()+"&token="+$("#enc_work").val()+"&totalQuestionNum="+totalQuestionNum; //表单目标
    		var ajax_type = $("#form1").attr('method'); //提交方法
    		var ajax_data = $("#form1").serialize(); //表单数据
			ajax_url += '&ua='+clientType();
            ajax_url += '&formType=' + getformType();
            ajax_url += '&saveStatus=' + 1;
            ajax_url += '&version=1';


    		$.ajax({

    			type : ajax_type,
    			url : ajax_url,
    			data :ajax_data,
    			dataType : "json",
    			success : function(data){
    				if (data.status) {
						alert("保存成功");
						window.location.reload();
					} else {
						alert(data.msg);
					}
    			},
                complete: function(){
                  tempSave=false;
                  $("#tempsave").text("暂时保存");
             }
    		});
    	}

		function clientType(){
			var userAgent = navigator.userAgent;
			var ua = "pc";
        	try{
				if(userAgent.indexOf("ChaoXingStudy") > -1){
					ua = "app";
				}
			}catch(e){}

			return ua;
    	}

        function getformType(){
            var form_type = $("#form1").attr('method'); //提交方法
            if(form_type){
                return form_type;
            }
            return "post";
        }

    	function addcheck(id){
        	setTimeout(function() {
        		var checkvalue = document.getElementsByName("answercheck"+id);
        		var checkradiovalue = "";
        		for(var i = 0; i < checkvalue.length; i++){
        			if(checkvalue[i].checked){
        				checkradiovalue += checkvalue[i].value;
        			}
        		}
        		document.getElementById("answer"+id).value = checkradiovalue;
        	},200);
    	}


    //连线题处理
	function getOneConnLineAnswer(obj){
		var answerPair=[];
		$(obj).each(function(index){
			var checked=$(this).val();
			var obj={};
			obj.name=(index+1);
			obj.content=(checked);
			answerPair.push(obj);
		});
		var answerStr=JSON.stringify(answerPair);
        return answerStr;
	}

	function setConnLineAnswer(){
		var input_connLine=$("input[name^='answertype'][value='11']");
		$(input_connLine).each(function(){
		var selectEle=$(this).parent().find(".thirdUlList select");
		var answer=getOneConnLineAnswer(selectEle);
		$(this).prev().val(answer);
		//console.log($(this).prev().val());
		});
	}

	//排序题处理
	function setSortQuesAnswer(){
	    var input_sortQues=$("input[name^='answertype'][value='13']");
		$(input_sortQues).each(function(){
    		 var selectEle=$(this).parent().find(".sortQuesSelect select");
			 var answer="";
    		 $(selectEle).each(function(){
    		 answer=answer+$(this).val();
    		 });
    		$(this).prev().val(answer);
	 });
}

//程序题设置答案
    function setProceduralQuesAnswer(){
        var input_proceduralQues=$("input[name^='answertype'][value='17']");
        input_proceduralQues.each(function(){
            var answer = [];
            var div=$(this).parent();
            var quesId=div.find("input[name='quesId']").val();
            var language=div.find("#languageSelect").val();
            var editor=UE.getEditor('textarea'+quesId);
            var richcode=editor.getContent();
            var code=editor.getPlainTxt(); code=UE.utils.html(code);
            var item={};
            item.language=parseInt(language);
            item.answer=richcode;
            item.answerTxt=code;
            answer[0]=item;
            var answerStr = JSON.stringify(answer);
            $(this).prev().val(answerStr);
        });
   }

    //复合题型设置答案【新完型填空、新阅读理解、综合题】
    function setCompoundQuesAnswer(){
        var input_clozeTextQues=$("input[name^='answertype'][value='14']");
        $(input_clozeTextQues).each(function(){
             var answer=getClozeTextAnswer(this);
             //console.log("clozetext:"+answer);
             $(this).prev().val(answer);
        });
        var input_readComprehensionQues=$("input[name^='answertype'][value='15']");
        $(input_readComprehensionQues).each(function(){
             var answer=getReadComprehensionAnswer(this);
             //console.log("readComprehension:"+answer);
             $(this).prev().val(answer);
        });
        var input_complexQues=$("input[name^='answertype'][value='16']");
        $(input_complexQues).each(function(){
             var answer=getReadComprehensionAnswer(this);
             //console.log("readComprehension:"+answer);
             $(this).prev().val(answer);
        });
        var input_listeniongQues=$("input[name^='answertype'][value='19']");
        $(input_listeniongQues).each(function(){
             var answer=getReadComprehensionAnswer(this);
             //console.log("readComprehension:"+answer);
             $(this).prev().val(answer);
        });
   }

   //获取新完型填空答案
   function getClozeTextAnswer(obj){
        var answerObj={};
        var choiceList=$(obj).parent().find(".Cy_ulTop li");
        choiceList.each(function(index){
            var itemId=$(this).find("input[name='itemId']").val();
            var checked=$(this).find("input[type='radio']:checked").val();
            if(checked==undefined){
                checked="";
            }
            var info={};
            info.answer=checked;
            answerObj[itemId]=info;
        });
        var answer=[];
        answer.push(answerObj);
        var answerStr=JSON.stringify(answer);
        return answerStr;
   }

//获取新阅读理解、综合题答案
function getReadComprehensionAnswer(obj) {
	var answerObj = {};
	var rid = $(obj).attr("data");
	var quesList = $(obj).parent().find("input[name='readCompreHension-childType']");
	quesList.each(function(index) {
		var type = $(this).val();
		var itemId = $(this).next().val();
		var itemAnswer = "";
		switch (parseInt(type)) {
			case 0 :
			case 3 : {
				itemAnswer = $("input[type='radio'][name='answer" + itemId + "'][data='" + rid + "']:checked").val();
				if (type == 3) {
					itemAnswer = itemAnswer ? (itemAnswer == "true" ? true : false) : itemAnswer;
				}
				break;
			}
			case 1 : {
				$("input[type='checkbox'][name='answer" + itemId + "'][data='" + rid + "']:checked").each(function() {
					itemAnswer += $(this).val();
				});
				break;
			}
			case 2 : {
				var answerItem = [];
				var blankNum = $("input[name='" + itemId + "blankNum'][data='" + rid + "']").val();
				for (var i = 1; i <= blankNum; i++) {
					// var blankInputId = "answer" + itemId;
					// var answerEditorId = "answerEditor" + rid + itemId;
					// blankInputId = blankInputId + i;
					// answerEditorId = answerEditorId + i;
					// var blankInput = $("input[name='" + blankInputId + "'][data='" + rid + "']");
					// var answerItemStr = blankInput.val();
					// if (blankInput.parent().is(":hidden")) {
					// 	var answerEditorStr = UE.getEditor(answerEditorId).getContent();
					// 	answerItemStr = answerEditorStr;
					// }
                    var answerEditorId = "answerEditor" + rid + itemId;
                    answerEditorId = answerEditorId + i;
                    var answerEditorStr = UE.getEditor(answerEditorId).getContent();
                    var item = {};
					item.content = answerEditorStr;
					item.name = i.toString();
					answerItem.push(item);
				}
				itemAnswer = answerItem;
				break;
			}
			case 4 : {
				var answerEditorId = "answer" + rid + itemId;
				var answerEditorStr = UE.getEditor(answerEditorId).getContent();
				itemAnswer = answerEditorStr;
				break;
			}
			default : {}
		}

		var info = {};
		info.type = parseInt(type);

		info.answer = (itemAnswer != undefined ? itemAnswer : "");
		answerObj[itemId] = info;
	});
	var answer = [];
	answer.push(answerObj);
	var answerStr = JSON.stringify(answer);
	return answerStr;
}

    </script>
    <style>
    	.Zy_ulTop{border-bottom:none}
    	.Zy_ulTop li:hover{background:#e9f3f7;}
    	#ZyBottom .TiMu img{
    		max-width:558px;
    	}

    	.edui-for-mathml .edui-dialog-wrap .edui-dialog-body{
    		width:625px;
    	}

    	.edui-default .edui-for-mathml .edui-dialog-content{
    		width:625px;
    	}

    	.x-container x-fit-item x-container-default{
    		width:610px;
    	}
	.ulTop span{margin-right:0px;}
	.thirdUlList{border-bottom:none;}
	.ulTop .tip{left: 12% !important;}
	.ulTop a{color:#202020;}
    </style>
</body>
</html>
